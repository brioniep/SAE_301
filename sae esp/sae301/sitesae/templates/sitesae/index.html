{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <title>Contrôle de la prise connectée</title>
</head>
<body>
    <h1>Contrôle de la prise connectée</h1>

    <!-- Ajout du bouton Se déconnecter -->
    <div>
        <form action="{% url 'sitesae/logout' %}" method="POST">
            {% csrf_token %}
            <button type="submit">Se déconnecter</button>
        </form>
    </div>

    <div id="temperature">
        <p>Température actuelle : <span id="temp_value">--</span>°C</p>
    </div>

    <div>
        <h2>Contrôle des prises</h2>
        <button onclick="window.location.href='{% url 'turn_on' 1 %}'">Allumer Prise 1</button>
        <button onclick="window.location.href='{% url 'turn_off' 1 %}'">Éteindre Prise 1</button>
        <br>
        <button onclick="window.location.href='{% url 'turn_on' 2 %}'">Allumer Prise 2</button>
        <button onclick="window.location.href='{% url 'turn_off' 2 %}'">Éteindre Prise 2</button>
        <br>
        <button onclick="window.location.href='{% url 'turn_on_all' %}'">Allumer les deux prises</button>
        <button onclick="window.location.href='{% url 'turn_off_all' %}'">Éteindre les deux prises</button>
    </div>

    <script>
        // Récupération des données de température
        function fetchTemperature() {
            fetch('/temperature/')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('temp_value').textContent = data.temperature;
                });
        }

        setInterval(fetchTemperature, 5000);  // Mise à jour de la température toutes les 5 secondes
    </script>
</body>
</html>
